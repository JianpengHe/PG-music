const { encode, decode } = require("./convert");
const zlib = require("zlib");
const str = `[10,10]和平饭店 - 陈奕迅 (Eason Chan)(10,10)
[20,20]词：林夕(20,20)
[30,30]曲：D.Acconci/云超(30,30)
[8342,1548] (8342,585)词(8927,218): (9145,201)林(9346,174)夕(9520,170) (9690,196)
[9590,1323] (9590,470)曲(10060,190): (10250,161)云(10411,164)超(10575,170) (10745,166)
[16318,4605]住(16318,553)楼(16871,410)下(17281,251)楼(17532,224)上(17756,1479)他(19235,252)住(19487,269)楼(19756,214)上(19970,358)楼(20328,197)下(20525,391)
[21975,4490]我(21975,579)是(22554,236)谁(22790,295)敌(23085,254)人(23339,221)为(23560,210)何(23770,255)邻(24025,360)居(24385,245)要(24630,296)互(24926,312)相(25238,422)轰(25660,406)炸(26066,394)
[26535,2850]来(26535,565)看(27100,246)风(27346,338)景(27684,167)宾(27851,169)客(28020,175)最(28195,168)初(28363,162)充(28525,160)满(28685,170)喜(28855,147)庆(29002,382)
[29400,2810]饭(29400,485)店(29885,215)挤(30100,310)拥(30410,361)租(30771,174)客(30945,170)不(31115,165)再(31280,170)和(31450,450)平(31900,310)
[32455,3220]为(32455,505)了(32960,205)不(33165,205)似(33370,194)他(33564,277)他(33841,199)看(34040,180)不(34220,205)起(34425,190)他(34615,165)那(34780,164)德(34944,421)性(35365,303)
[35705,2847]二(35705,605)二(36310,178)六(36488,196)号(36684,136)为(36820,180)什(37000,173)么(37173,248)被(37421,194)夺(37615,306)命(37921,630)
[38940,6385]你(38940,2060)住(41000,163)楼(41163,187)下(41350,212)楼(41562,178)上(41740,145)他(41885,1445)住(43330,421)楼(43751,174)上(43925,320)楼(44245,199)下(44444,872)
[45892,4606]我(45892,659)是(46551,229)谁(46780,195)情(46975,286)人(47261,204)为(47465,230)何(47695,215)邻(47910,256)居(48166,254)要(48420,295)互(48715,265)相(48980,320)牵(49300,330)挂(49630,864)
[50502,2724]来(50502,550)去(51052,231)匆(51283,212)匆(51495,200)竟(51695,180)要(51875,195)对(52070,96)方(52166,220)分(52386,180)你(52566,169)一(52735,165)半(52900,322)
[53415,2973]旧(53415,585)爱(54000,205)新(54205,197)欢(54402,204)不(54606,190)过(54796,183)找(54979,186)过(55165,180)玩(55345,190)伴(55535,850)
[56360,3130]住(56360,526)客(56886,264)请(57150,251)记(57401,226)得(57627,213)总(57840,167)有(58007,173)某(58180,178)天(58358,157)租(58515,180)约(58695,166)将(58861,167)满(59028,453)
[59420,3000]二(59420,546)万(59966,269)日(60235,235)后(60470,266)住(60736,204)户(60940,187)将(61127,183)被(61310,180)调(61490,725)换(62215,200)
[88024,5195]你(88024,615)住(88639,231)楼(88870,350)下(89220,204)楼(89424,184)上(89608,1466)他(91074,244)住(91318,371)楼(91689,195)上(91884,345)楼(92229,212)下(92441,772)
[93679,4540]世(93679,570)上(94249,345)谁(94594,251)及(94845,194)谁(95039,191)丑(95230,204)陋(95434,455)美(95889,197)好(96086,258)也(96344,291)互(96635,419)相(97054,455)宽(97509,215)恕(97724,275)吧(97999,215)
[97919,6251]忘(97919,3110)掉(101029,227)你(101256,248)手(101504,260)中(101764,305)石(102069,561)头(102630,1537)
[104697,2087]尽(104697,608)兴(105305,289)吧(105594,295)尽(105889,245)兴(106134,365)吧(106499,276)
[106759,6551]就(106759,525)似(107284,255)相(107539,215)亲(107754,280)相(108034,250)爱(108284,200)娱(108484,206)乐(108690,214)大(108904,455)家(109359,3950)
[115259,14869]你(115259,9106)住(124365,308)楼(124673,370)下(125043,245)楼(125288,210)上(125498,1527)他(127025,267)住(127292,301)楼(127593,211)上(127804,235)楼(128039,246)下(128285,1842)
[129828,1685]要(129828,565)令(130393,221)谁(130614,229)像(130843,305)谁(131148,365)
[131213,3445]为(131213,520)何(131733,260)邻(131993,241)居(132234,236)要(132470,249)互(132719,414)相(133133,640)惊(133773,305)化(134078,579)
[134358,6455]你(134358,634)住(134992,1648)楼(136640,243)下(136883,309)楼(137192,941)上(138133,290)他(138423,400)住(138823,416)楼(139239,554)上(139793,275)楼(140068,280)下(140348,462)
[141383,2130]要(141383,760)令(142143,392)谁(142535,314)像(142849,284)谁(143133,375)
[143425,2993]为(143425,540)何(143965,230)邻(144195,281)居(144476,287)要(144763,395)互(145158,265)相(145423,220)惊(145643,240)化(145883,529)
[146438,7446]为(146438,580)何(147018,230)邻(147248,225)居(147473,195)要(147668,180)互(147848,182)相(148030,153)感(148183,230)化(148413,165)梦(148578,182)游(148760,883)人(149643,267)间(149910,468)快(150378,450)互(150828,307)相(151135,342)拥(151477,370)抱(151847,261)吧(153884,200)`;

const go = (d) => {
  const t = encode(d);
  console.log(
    // zlib.deflateSync(Buffer.from(d)).length,
    Buffer.from(t).length,
    // zlib.deflateSync(Buffer.from(t)).length,
    // zlib.deflateSync(Buffer.from(t.replace(/[\ue000-\uf8ff]/g, ""))).length
    // t.match(/([^\ue000-\uf8ff]+?)([\ue000-\uf8ff]+?)/g),
    t.replace(/[\ue000-\uf8ff]/g, "")
  );
  const out = decode(t);
  out.forEach((a) => console.log(a));
  // console.log();
};

const song_id = process.argv[2];
if (song_id) {
  require(__dirname + "/online")
    .getLyricOnline(Number(song_id))
    .then(go);
} else {
  go(str);
}

// console.log(
//   Buffer.from(String.fromCharCode(0xe000)),
//   Buffer.from(String.fromCharCode(0xf8ff)),
//   Buffer.from("发")
// );
